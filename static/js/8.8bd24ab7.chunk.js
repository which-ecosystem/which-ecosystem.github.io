(this.webpackJsonpwhich=this.webpackJsonpwhich||[]).push([[8],{252:function(e,t,a){"use strict";var n=a(251),i=a(0),c=a.n(i),r=a(282),l=a(60),o=a(105),u=a(351),s=a(381),m=a(382),h=a(71),f=a(277),d=a.n(f),g=Object(o.a)({root:{position:"absolute",color:"white",top:"86%",fontSize:20,textShadow:"0 0 3px black",display:"flex",alignItems:"center"},left:{left:30},right:{right:30}}),v=function(e){var t=e.value,a=e.which,n=e.like,i=g();return c.a.createElement("div",{className:"".concat(i.root," ").concat(i[a])},n&&c.a.createElement(d.a,null),"".concat(t,"%"))},p=a(69),b=a(31),E=a(32),j={month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"},O=Object(o.a)((function(e){return{images:{height:e.spacing(50)},imagesBlock:{display:"flex"},rateLine:{position:"relative",width:"100%",height:e.spacing(2),backgroundColor:e.palette.primary.light,transitionDuration:"0.5s"},highlight:{backgroundColor:"".concat(e.palette.primary.main," !important")},fillRateLine:{height:e.spacing(2),backgroundColor:e.palette.primary.light,transitionDuration:"0.5s"}}})),w=function(e){var t,a,n=e.poll,i=e.setPoll,r=O(),o=n.author,f=n.contents,d=f.left,g=f.right,w=n.vote,y=Object(h.b)().enqueueSnackbar,k=Object(E.b)().isAuthenticated,x=new Date(n.createdAt).toLocaleString("default",j),S=function(e){if(k)if(w)y("You have already voted in this poll",{variant:"error"});else{var t={which:e,pollId:n._id},a=Object(l.a)({},n);a.contents[e].votes+=1,a.vote=Object(l.a)({_id:"",authorId:"",createdAt:new Date},t),i(a),Object(b.c)("votes/",t)}else y("Unauthorized users can not vote in polls",{variant:"error"})};d.votes||g.votes?a=100-(t=Math.round(d.votes/(d.votes+g.votes)*100)):(t=0,a=0);var C=d.votes>=g.votes?"left":"right";return c.a.createElement(u.a,null,c.a.createElement(p.a,{user:o,info:x}),c.a.createElement("div",{className:r.imagesBlock},c.a.createElement(s.a,{onDoubleClick:function(){return S("left")}},c.a.createElement(m.a,{className:r.images,image:d.url}),c.a.createElement(v,{value:t,which:"left",like:"left"===(null===w||void 0===w?void 0:w.which)})),c.a.createElement(s.a,{onDoubleClick:function(){return S("right")}},c.a.createElement(m.a,{className:r.images,image:g.url}),c.a.createElement(v,{value:a,which:"right",like:"right"===(null===w||void 0===w?void 0:w.which)}))),c.a.createElement("div",{className:"".concat(r.rateLine," ").concat("right"===C?r.highlight:"")},c.a.createElement("div",{className:"".concat(r.fillRateLine," ").concat("left"===C?r.highlight:""),style:{width:"".concat(t,"%")}})))};t.a=function(e){var t=e.polls,a=e.mutate,i=function(e){var i=e.index,r=e.style,l=e.key,o=t[i];return c.a.createElement("div",{key:"".concat(l,"-").concat(o._id,"-").concat(t.length),style:r},c.a.createElement(w,{poll:o,setPoll:function(e){var c=Object(n.a)(t);c[i]=e,a([],!1),a(c,!1)}}))};return c.a.createElement(r.c,null,(function(e){var a=e.height,n=e.isScrolling,l=e.registerChild,o=e.onChildScroll,u=e.scrollTop;return c.a.createElement(r.a,{disableHeight:!0},(function(e){var s=e.width;return c.a.createElement("div",{ref:l},c.a.createElement(r.b,{autoHeight:!0,height:a,isScrolling:n,onScroll:o,rowCount:t.length,rowHeight:550,rowRenderer:i,scrollTop:u,width:s,containerStyle:{pointerEvents:"auto"},overscanRowCount:1}))}))}))}},392:function(e,t,a){"use strict";a.r(t);var n=a(251),i=a(0),c=a.n(i),r=a(383),l=a(252),o=a(59),u=a.n(o),s=a(73),m=a(16),h=a(105),f=a(193),d=a(174),g=a(351),v=a(177),p=a(286),b=a(71),E=a(80),j=a.n(E),O=a(352),w=a(358),y=a.n(w),k=a(57),x=a(382),S=a(381),C=a(359),N=a.n(C),F=Object(h.a)({root:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},clearIcon:{opacity:".5",fontSize:50},media:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},text:{textAlign:"center"}}),I=function(e){var t=e.file,a=e.setFile,n=F(),r=Object(O.useFilePicker)(),l=r.files,o=r.onClick,u=r.HiddenFileInput,s=Object(i.useState)(),h=Object(m.a)(s,2),f=h[0],d=h[1],g=Object(i.useState)(!1),v=Object(m.a)(g,2),p=v[0],b=v[1];Object(i.useEffect)((function(){if(null===l||void 0===l?void 0:l.length){var e=l[0];a(e),O.utils.loadFile(e).then((function(e){return d(e)}))}}),[l,a]);var E=c.a.createElement(c.a.Fragment,null,c.a.createElement(y.a,{fontSize:"large",color:"primary"}),c.a.createElement(k.a,{variant:"h5",className:n.text}," Upload an image "),c.a.createElement(u,{accept:".jpg, .jpeg, .png, .gif",multiple:!1})),j=c.a.createElement(x.a,{image:f,className:n.media,onMouseEnter:function(){b(!0)},onMouseLeave:function(){b(!1)}},p&&c.a.createElement(N.a,{className:n.clearIcon}));return c.a.createElement(c.a.Fragment,null,c.a.createElement(S.a,{onClick:function(){t?a(void 0):o()},className:n.root},t?f&&j:E))},D=a(69),P=a(31),A=a(32),L=Object(h.a)((function(e){return{root:{marginBottom:e.spacing(4)},images:{height:e.spacing(50),display:"flex"}}})),z=function(e){var t=e.addPoll,a=L(),n=Object(i.useState)(!1),r=Object(m.a)(n,2),l=r[0],o=r[1],h=Object(i.useState)(),E=Object(m.a)(h,2),O=E[0],w=E[1],y=Object(i.useState)(),k=Object(m.a)(y,2),x=k[0],S=k[1],C=Object(b.b)().enqueueSnackbar,N=Object(A.b)().user,F=O&&x,z=function(e){var t={"Content-Type":"image/png"};return Object(P.a)("/files").then((function(e){return e.data})).then((function(a){return j.a.put(a,e,{headers:t})})).then((function(e){var t=e.config.url;return t&&t.slice(0,t.indexOf(".png")+4)}))},H=function(){var e=Object(s.a)(u.a.mark((function e(){var a,n,i,c,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l||!F){e.next=9;break}return e.next=3,Promise.all([z(O),z(x)]);case 3:a=e.sent,n=Object(m.a)(a,2),i=n[0],c=n[1],r={left:{url:i},right:{url:c}},Object(P.c)("/polls/",{contents:r}).then((function(e){t(e.data),C("Your poll has been successfully created!",{variant:"success"})}));case 9:o(!l);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c.a.createElement(d.a,{onClickAway:function(){o(!1)}},c.a.createElement(g.a,{className:a.root},c.a.createElement(f.a,{in:l,timeout:"auto",unmountOnExit:!0},N&&c.a.createElement(D.a,{user:N,info:""}),c.a.createElement(v.a,null),c.a.createElement("div",{className:a.images},c.a.createElement(I,{file:O,setFile:w}),c.a.createElement(I,{file:x,setFile:S}))),c.a.createElement(p.a,{color:"primary",disabled:l&&!F,variant:l?"contained":"outlined",onClick:H,fullWidth:!0},l?"Submit":"Create a Poll")))},H=a(72);t.default=function(){var e=Object(H.a)(),t=e.data,a=e.mutate,i=Object(A.b)().isAuthenticated;return c.a.createElement(r.a,{maxWidth:"sm",disableGutters:!0},i&&c.a.createElement(z,{addPoll:function(e){a([e].concat(Object(n.a)(t)),!0)}}),c.a.createElement(l.a,{polls:t,mutate:a}))}}}]);
//# sourceMappingURL=8.8bd24ab7.chunk.js.map