{"version":3,"sources":["components/Fab/Fab.tsx","components/PollCard/PercentageBar.tsx","components/PollCard/PollCard.tsx","components/PollsList/PollsList.tsx","containers/Feed/Feed.tsx"],"names":["useStyles","makeStyles","theme","root","zIndex","position","breakpoints","down","right","spacing","bottom","up","Fab","hideOnScroll","classes","history","useHistory","trigger","useScrollTrigger","appear","direction","in","onClick","push","className","color","top","fontSize","textShadow","display","alignItems","left","PercentageBar","value","which","like","DATE_FORMAT","month","day","year","hour","minute","images","height","imagesBlock","rateLine","width","backgroundColor","palette","primary","light","transitionDuration","highlight","main","fillRateLine","PollCard","leftPercentage","rightPercentage","poll","setPoll","author","contents","vote","enqueueSnackbar","useSnackbar","isAuthenticated","useAuth","date","Date","createdAt","toLocaleString","handleVote","variant","newVote","pollId","_id","newPoll","votes","authorId","post","Math","round","dominant","Card","UserStrip","user","info","CardActionArea","onDoubleClick","CardMedia","image","url","style","PollsList","polls","mutate","RenderItem","index","key","length","newPolls","isScrolling","registerChild","onChildScroll","scrollTop","disableHeight","ref","autoHeight","onScroll","rowCount","rowHeight","rowRenderer","containerStyle","pointerEvents","overscanRowCount","Feed","useFeed","data","maxWidth","disableGutters"],"mappings":"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","file":"static/js/9.ff78e660.chunk.js","sourcesContent":["import React from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { Fab as FabBase, Slide, useScrollTrigger } from '@material-ui/core/';\nimport { makeStyles } from '@material-ui/core/styles';\nimport PlusIcon from '@material-ui/icons/Add';\n\ninterface PropTypes {\n  hideOnScroll?: boolean;\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    zIndex: 1000,\n    position: 'fixed',\n\n    [theme.breakpoints.down('sm')]: {\n      right: theme.spacing(2),\n      bottom: theme.spacing(8)\n    },\n    [theme.breakpoints.up('md')]: {\n      right: theme.spacing(5),\n      bottom: theme.spacing(5)\n    }\n  }\n}));\n\nconst Fab: React.FC<PropTypes> = ({ hideOnScroll = false }) => {\n  const classes = useStyles();\n  const history = useHistory();\n  const trigger = useScrollTrigger();\n\n  const handleClick = () => {\n    history.push('/new');\n  };\n\n  return (\n    <Slide appear={false} direction=\"up\" in={(!hideOnScroll) || !trigger}>\n      <FabBase\n        onClick={handleClick}\n        className={classes.root}\n        color=\"secondary\"\n      >\n        <PlusIcon />\n      </FabBase>\n    </Slide>\n  );\n};\n\nexport default Fab;\n\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport LikeIcon from '@material-ui/icons/Favorite';\n\ninterface PropTypes {\n  value: number;\n  which: 'left' | 'right';\n  like: boolean;\n}\n\nconst useStyles = makeStyles({\n  root: {\n    position: 'absolute',\n    color: 'white',\n    top: '86%',\n    fontSize: 20,\n    textShadow: '0 0 3px black',\n    display: 'flex',\n    alignItems: 'center'\n  },\n  left: {\n    left: 30\n  },\n  right: {\n    right: 30\n  }\n});\n\nconst PercentageBar: React.FC<PropTypes> = ({ value, which, like }) => {\n  const classes = useStyles();\n\n  return (\n    <div className={`${classes.root} ${classes[which]}`}>\n      {like && <LikeIcon />}\n      {`${value}%`}\n    </div>\n  );\n};\n\n\nexport default PercentageBar;\n\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n  Card,\n  CardActionArea,\n  CardMedia\n} from '@material-ui/core/';\nimport { Which, Poll } from 'which-types';\nimport { useSnackbar } from 'notistack';\n\nimport PercentageBar from './PercentageBar';\nimport UserStrip from '../UserStrip/UserStrip';\nimport { post } from '../../requests';\nimport { useAuth } from '../../hooks/useAuth';\n\ninterface PropTypes {\n  poll: Poll;\n  setPoll: (poll: Poll) => void;\n}\n\nconst DATE_FORMAT = {\n  month: 'long',\n  day: 'numeric',\n  year: 'numeric',\n  hour: '2-digit',\n  minute: '2-digit'\n};\n\nconst useStyles = makeStyles(theme => ({\n  images: {\n    height: theme.spacing(50)\n  },\n  imagesBlock: {\n    display: 'flex'\n  },\n  rateLine: {\n    position: 'relative',\n    width: '100%',\n    height: theme.spacing(2),\n    backgroundColor: theme.palette.primary.light,\n    transitionDuration: '0.5s'\n  },\n  highlight: {\n    backgroundColor: `${theme.palette.primary.main} !important`\n  },\n  fillRateLine: {\n    height: theme.spacing(2),\n    backgroundColor: theme.palette.primary.light,\n    transitionDuration: '0.5s'\n  }\n}));\n\nconst PollCard: React.FC<PropTypes> = ({ poll, setPoll }) => {\n  const classes = useStyles();\n  const { author, contents: { left, right }, vote } = poll;\n  const { enqueueSnackbar } = useSnackbar();\n  const { isAuthenticated } = useAuth();\n  const date: string = new Date(poll.createdAt).toLocaleString('default', DATE_FORMAT);\n\n  const handleVote = (which: Which) => {\n    if (!isAuthenticated) {\n      enqueueSnackbar('Unauthorized users can not vote in polls', {\n        variant: 'error'\n      });\n    } else if (vote) {\n      enqueueSnackbar('You have already voted in this poll', {\n        variant: 'error'\n      });\n    } else {\n      const newVote = ({ which, pollId: poll._id });\n      const newPoll = { ...poll };\n      newPoll.contents[which].votes += 1;\n      newPoll.vote = {\n        _id: '',\n        authorId: '',\n        createdAt: new Date(),\n        ...newVote\n      };\n      setPoll(newPoll);\n\n      post('votes/', newVote);\n    }\n  };\n\n  const handleLeft = () => handleVote('left');\n  const handleRight = () => handleVote('right');\n\n  let leftPercentage;\n  let rightPercentage;\n\n  if (left.votes || right.votes) {\n    leftPercentage = Math.round(100 * (left.votes / (left.votes + right.votes)));\n    rightPercentage = 100 - leftPercentage;\n  } else {\n    leftPercentage = 0;\n    rightPercentage = 0;\n  }\n\n  const dominant: Which = left.votes >= right.votes ? 'left' : 'right';\n\n  return (\n    <Card>\n      <UserStrip user={author} info={date} />\n      <div className={classes.imagesBlock}>\n        <CardActionArea onDoubleClick={handleLeft}>\n          <CardMedia\n            className={classes.images}\n            image={left.url}\n          />\n          <PercentageBar value={leftPercentage} which=\"left\" like={vote?.which === 'left'} />\n        </CardActionArea>\n        <CardActionArea onDoubleClick={handleRight}>\n          <CardMedia\n            className={classes.images}\n            image={right.url}\n          />\n          <PercentageBar value={rightPercentage} which=\"right\" like={vote?.which === 'right'} />\n        </CardActionArea>\n      </div>\n      <div className={`${classes.rateLine} ${dominant === 'right' ? classes.highlight : ''}`}>\n        <div\n          className={`${classes.fillRateLine} ${dominant === 'left' ? classes.highlight : ''}`}\n          style={{ width: `${leftPercentage}%` }}\n        />\n      </div>\n    </Card>\n  );\n};\n\nexport default PollCard;\n","import React from 'react';\nimport { Poll } from 'which-types';\nimport { WindowScroller, AutoSizer, List } from 'react-virtualized';\nimport PollCard from '../PollCard/PollCard';\n\n\ninterface PropTypes {\n  polls: Poll[];\n  mutate: (polls: Poll[], refetch: boolean) => void;\n}\n\ninterface RenderPropTypes {\n  index: number;\n  key: string;\n  style: React.CSSProperties;\n}\n\n\nconst PollsList: React.FC<PropTypes> = ({ polls, mutate }) => {\n  const RenderItem: React.FC<RenderPropTypes> = ({ index, style, key }) => {\n    const poll = polls[index];\n\n    const setPoll = (newPoll: Poll) => {\n      const newPolls = [...polls];\n      newPolls[index] = newPoll;\n\n      // Force-update list-size so everything re-renders\n      mutate([], false);\n      mutate(newPolls, false);\n    };\n\n    return (\n      // To re-render on list resize, add this info to key\n      <div key={`${key}-${poll._id}-${polls.length}`} style={style}>\n        <PollCard poll={poll} setPoll={setPoll} />\n      </div>\n    );\n  };\n\n  return (\n    <WindowScroller>\n      {({\n        height,\n        isScrolling,\n        registerChild,\n        onChildScroll,\n        scrollTop\n      }) => (\n        <AutoSizer disableHeight>\n          {({ width }) => (\n            <div ref={registerChild}>\n              <List\n                autoHeight\n                height={height}\n                isScrolling={isScrolling}\n                onScroll={onChildScroll}\n                rowCount={polls.length}\n                rowHeight={550}\n                rowRenderer={RenderItem}\n                scrollTop={scrollTop}\n                width={width}\n                containerStyle={{ pointerEvents: 'auto' }}\n                overscanRowCount={1}\n              />\n            </div>\n          )}\n        </AutoSizer>\n      )}\n    </WindowScroller>\n  );\n};\n\nexport default PollsList;\n\n","import React from 'react';\nimport { Container } from '@material-ui/core/';\n\nimport PollsList from '../../components/PollsList/PollsList';\nimport Fab from '../../components/Fab/Fab';\nimport { useAuth } from '../../hooks/useAuth';\nimport { useFeed } from '../../hooks/APIClient';\n\n\nconst Feed: React.FC = () => {\n  const { data: polls, mutate } = useFeed();\n  const { isAuthenticated } = useAuth();\n\n  return (\n    <Container maxWidth=\"sm\" disableGutters>\n      {isAuthenticated && <Fab hideOnScroll />}\n      <PollsList polls={polls} mutate={mutate} />\n    </Container>\n  );\n};\n\nexport default Feed;\n\n"],"sourceRoot":""}