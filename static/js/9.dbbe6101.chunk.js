(this.webpackJsonpwhich=this.webpackJsonpwhich||[]).push([[9],{314:function(e,t,a){"use strict";var n=a(37),r=a(0),i=a.n(r),o=a(12),c=a(33),l=a(223),s=a(182),u=a(454),m=a(57),d=a(356),h=a.n(d),v=Object(m.a)((function(e){var t;return{root:(t={zIndex:1e3,position:"fixed"},Object(n.a)(t,e.breakpoints.down("sm"),{right:e.spacing(2),bottom:e.spacing(8)}),Object(n.a)(t,e.breakpoints.up("md"),{right:e.spacing(5),bottom:e.spacing(5)}),t)}}));t.a=function(e){var t=e.hideOnScroll,a=void 0!==t&&t,n=v(),r=Object(o.g)(),m=Object(l.a)();return i.a.createElement(s.a,{appear:!1,direction:"up",in:!a||!m},i.a.createElement(c.b,{to:{pathname:"/new",state:{background:r}}},i.a.createElement(u.a,{className:n.root,color:"secondary"},i.a.createElement(h.a,null))))}},330:function(e,t,a){"use strict";var n=a(27),r=a.n(n),i=a(36),o=a(7),c=a(0),l=a.n(c),s=a(292),u=a(95),m=a.n(u),d=a(368),h=a(57),v=a(354),p=a(241),g=a(32),f=a(237),b=a(66),w=a(355),E=a.n(w),O=Object(h.a)({root:{position:"absolute",color:"white",top:"86%",fontSize:20,textShadow:"0 0 3px black",display:"flex",alignItems:"center"},left:{left:30},right:{right:30}}),j=function(e){var t=e.value,a=e.which,n=e.like,r=O();return l.a.createElement("div",{className:"".concat(r.root," ").concat(r[a])},n&&l.a.createElement(E.a,null),"".concat(t,"%"))},k=a(64),y=[{name:"minute",ratio:60},{name:"hour",ratio:60},{name:"day",ratio:24},{name:"week",ratio:7},{name:"month",ratio:4},{name:"year",ratio:12}],x=function(e){var t=((new Date).valueOf()-e.valueOf())/1e3;return t<60?"just now":function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=y[a],r=y[a+1],i=t/n.ratio;if(i<.85*r.ratio){var o=Math.round(i),c=o>1,l=c?o:"a",s=c?"s":"";return"".concat(l," ").concat(n.name).concat(s," ago")}return"year"===n.name?"A year ago":e(i,a+1)}(t)},C=Object(h.a)({root:{display:"block",cursor:"pointer"}}),N={month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"},S=function(e){var t=e.value,a=Object(c.useState)(!0),n=Object(o.a)(a,2),r=n[0],i=n[1],s=C(),u=Object(c.useCallback)((function(){return i((function(e){return!e}))}),[i]),m=Object(c.useMemo)((function(){return new Date(t)}),[t]),d=Object(c.useMemo)((function(){return m.toLocaleString("default",N)}),[m]),h=Object(c.useMemo)((function(){return x(m)}),[m]);return l.a.createElement("div",{role:"presentation",className:s.root,onClick:u},r?h:d)},M=a(98),I=a(26),A=a(34),R=Object(h.a)((function(e){return{media:{display:"flex",height:e.spacing(50)},rateLine:{position:"relative",width:"100%",height:e.spacing(2),backgroundColor:e.palette.primary.light,transitionDuration:"0.5s"},highlight:{backgroundColor:"".concat(e.palette.primary.main," !important")},fillRateLine:{height:e.spacing(2),backgroundColor:e.palette.primary.light,transitionDuration:"0.5s"},description:{fontSize:14,padding:e.spacing(0,2,1.25),wordWrap:"break-word",whiteSpace:"pre-wrap"}}})),D=l.a.memo((function(e){var t,a,n=e.poll,r=e.setPoll,i=R(),o=n.author,c=n.contents,s=c.left,u=c.right,m=n.vote,d=Object(b.b)().enqueueSnackbar,h=Object(A.b)().isAuthenticated,w=function(e){return function(){if(h)if(m)d("You have already voted in this poll",{variant:"error"});else{var t={which:e,pollId:n._id},a=Object(v.a)({},n);a.contents[e].votes+=1,a.vote=Object(v.a)({_id:"",authorId:"",createdAt:new Date},t),r(a),Object(I.c)("votes/",t)}else d("Unauthorized users can not vote in polls",{variant:"error"})}};s.votes||u.votes?a=100-(t=Math.round(s.votes/(s.votes+u.votes)*100)):(t=0,a=0);var E=s.votes>=u.votes?"left":"right";return l.a.createElement(p.a,{elevation:3},l.a.createElement(k.a,{user:o,info:l.a.createElement(S,{value:n.createdAt})}),n.description&&l.a.createElement(g.a,{className:i.description},n.description),l.a.createElement("div",{className:i.media},l.a.createElement(f.a,{onDoubleClick:w("left"),className:i.media},l.a.createElement(M.a,{src:s.url}),l.a.createElement(j,{value:t,which:"left",like:"left"===(null===m||void 0===m?void 0:m.which)})),l.a.createElement(f.a,{onDoubleClick:w("right"),className:i.media},l.a.createElement(M.a,{src:u.url}),l.a.createElement(j,{value:a,which:"right",like:"right"===(null===m||void 0===m?void 0:m.which)}))),l.a.createElement("div",{className:"".concat(i.rateLine," ").concat("right"===E?i.highlight:"")},l.a.createElement("div",{className:"".concat(i.fillRateLine," ").concat("left"===E?i.highlight:""),style:{width:"".concat(t,"%")}})))})),L=Object(h.a)((function(e){return{root:{paddingBottom:e.spacing(8)}}})),_=l.a.memo((function(e){var t=e.polls,a=e.mutate,n=e.index,r=e.style,i=e.cache,o=e.parent,u=e._key,m=L(),h=t[n],v=Object(c.useCallback)((function(e){var r=Object(d.a)(t);r[n]=e,a([],!1),a(r,!1)}),[a,n,t]);return l.a.createElement(s.b,{cache:i,columnIndex:0,rowIndex:n,parent:o},l.a.createElement("div",{key:"".concat(u,"-").concat(h._id),className:m.root,style:r},l.a.createElement(D,{poll:h,setPoll:v})))}),(function(e,t){return e._key===t._key&&(e.index===t.index&&(e.polls===t.polls&&e.style.height===t.style.height))})),T=new s.c({fixedWidth:!0});t.a=function(e){var t=e.polls,a=e.mutate,n=Object(c.useState)(10),u=Object(o.a)(n,2),d=u[0],h=u[1];Object(c.useEffect)((function(){T.clearAll()}),[t]);var v=Object(c.useCallback)((function(e){var n=e.index,r=e.style,i=e.key,o=e.parent;return l.a.createElement(_,{polls:t,mutate:a,index:n,style:r,cache:T,parent:o,key:i,_key:i})}),[t,a]),p=Object(c.useCallback)(Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h((function(e){return e+10}));case 1:case"end":return e.stop()}}),e)}))),[]),g=Object(c.useCallback)((function(e){return e.index<d-1||d===t.length}),[d,t]),f=Object(c.useMemo)((function(){return m.a.min([d,t.length])||t.length}),[d,t.length]);return l.a.createElement(s.f,null,(function(e){var t=e.height,a=e.isScrolling,n=e.registerChild,r=e.onChildScroll,i=e.scrollTop;return l.a.createElement(s.a,{disableHeight:!0},(function(e){var o=e.width;return l.a.createElement("div",{ref:n},l.a.createElement(s.d,{isRowLoaded:g,loadMoreRows:p,rowCount:f,threshold:1},(function(e){var n=e.onRowsRendered,c=e.registerChild;return l.a.createElement(s.e,{autoHeight:!0,height:t,isScrolling:a,onScroll:r,rowCount:f,rowHeight:T.rowHeight,rowRenderer:v,scrollTop:i,width:o,containerStyle:{pointerEvents:"auto"},overscanRowCount:2,onRowsRendered:n,ref:c,deferredMeasurementCache:T})})))}))}))}},464:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(12),o=a(240),c=a(27),l=a.n(c),s=a(36),u=a(7),m=a(451),d=a(137),h=a(32),v=a(452),p=a(453),g=a(57),f=a(450),b=Object(g.a)({root:{position:"relative"},menuButton:{width:200,height:50,textAlign:"center"},menuNumber:{fontWeight:800,color:"black"},menuText:{color:"darkgray"}}),w=function(e){var t=e.text,a=e.value,n=b();return r.a.createElement("div",{className:n.menuButton},r.a.createElement("div",{className:n.menuNumber},a),r.a.createElement("div",{className:n.menuText},t))},E=a(114),O=a(70),j=a(26),k=a(34),y=a(113),x=a(37),C=a(116),N=a.n(C),S=function(e){return new Promise((function(t,a){var n=new Image;n.addEventListener("load",(function(){return t(n)})),n.addEventListener("error",(function(e){return a(e)})),n.setAttribute("crossOrigin","anonymous"),n.src=e}))};function M(e,t){return I.apply(this,arguments)}function I(){return(I=Object(s.a)(l.a.mark((function e(t,a){var n,r,i,o,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:return n=e.sent,r=document.createElement("canvas"),i=r.getContext("2d"),o=Math.max(n.width,n.height),c=o/2*Math.sqrt(2)*2,r.width=c,r.height=c,i.translate(c/2,c/2),i.translate(-c/2,-c/2),i.drawImage(n,c/2-.5*n.width,c/2-.5*n.height),s=i.getImageData(0,0,c,c),r.width=a.width,r.height=a.height,i.putImageData(s,Math.round(0-c/2+.5*n.width-a.x),Math.round(0-c/2+.5*n.height-a.y)),e.abrupt("return",new Promise((function(e){r.toBlob((function(t){return e(t)}))})));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=a(444),R=a(468),D=Object(g.a)((function(e){return{cropperArea:Object(x.a)({position:"relative",width:"100%",height:"calc(100vh - 130px)",background:"#333"},e.breakpoints.up("sm"),{height:400}),sliderContainer:{padding:20}}})),L=function(e){var t=e.image,a=e.setArea,i=D(),o=Object(n.useState)({x:0,y:0}),c=Object(u.a)(o,2),l=c[0],s=c[1],m=Object(n.useState)(1),d=Object(u.a)(m,2),h=d[0],v=d[1],p=Object(n.useCallback)((function(e,t){a(t)}),[a]);return r.a.createElement("div",null,r.a.createElement("div",{className:i.cropperArea},r.a.createElement(A.a,{image:t,crop:l,zoom:h,aspect:1,cropShape:"round",showGrid:!1,onCropChange:s,onCropComplete:p,onZoomChange:v})),r.a.createElement("div",{className:i.sliderContainer},r.a.createElement(R.a,{value:h,min:1,max:3,step:.01,"aria-labelledby":"Zoom",onChange:function(){return v(h)}})))},_=a(115),T=Object(g.a)((function(e){return{cropContainer:Object(x.a)({position:"relative",width:"100%"},e.breakpoints.up("sm"),{})}})),B=function(e){var t=e.avatar,a=e.callback,i=T(),o=Object(n.useState)({x:0,y:0}),c=Object(u.a)(o,2),m=c[0],d=c[1],h=function(){var e=Object(s.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",M(t,m).then((function(e){return a(e)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(_.a,{title:"Choose area",actionIcon:r.a.createElement(N.a,null),handleAction:h,isActionDisabled:!1},r.a.createElement("div",{className:i.cropContainer},r.a.createElement(L,{image:t,setArea:d})))},P=Object(g.a)((function(e){return{root:{position:"relative",marginBottom:e.spacing(4)},avatar:{width:150,height:150,position:"relative",margin:"0 auto"},darken:{filter:"brightness(50%)"},name:{margin:e.spacing(1,0),display:"flex",alignItems:"center",justifyContent:"center"},verified:{marginLeft:e.spacing(.5),width:e.spacing(3),height:e.spacing(3)},profileMenu:{display:"flex",width:"100%",height:50,marginTop:e.spacing(6),borderBottom:"1px solid lightgray"},menuButton:{width:200,height:50,textAlign:"center"},badge:{width:e.spacing(5),height:e.spacing(5),borderRadius:"50%",cursor:"pointer",background:"#d3d3d3",display:"flex",alignItems:"center","& svg":{margin:"0 auto"}},avatarContainer:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},menuNumber:{fontWeight:800,color:"black"},menuText:{color:"darkgray"},skeleton:{margin:"10px auto",borderRadius:2},progress:{position:"absolute",color:"white"}}})),z=function(e){var t=e.savedPolls,a=e.totalVotes,i=e.setUserInfo,o=e.userInfo,c=P(),g=Object(k.b)().user,b=Object(n.useState)(0),x=Object(u.a)(b,2),C=x[0],N=x[1],S=Object(n.useState)(""),M=Object(u.a)(S,2),I=M[0],A=M[1],R=Object(n.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new Date(e),a="0".concat(t.getDate()).slice(-2),n="0".concat(t.getMonth()).slice(-2),r=t.getFullYear();return"".concat(r,"-").concat(n,"-").concat(a)}(null===o||void 0===o?void 0:o.createdAt)}),[o]),D=Object(n.useCallback)(function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g&&Object(y.a)(t,.8,N).then((function(e){return Object(j.b)("/users/".concat(g._id),{avatarUrl:e})})).then((function(e){return i(e.data)})).then((function(){return N(0)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[g,i]),L=Object(n.useCallback)(function(){var e=Object(s.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=URL.createObjectURL(t),A(a);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return r.a.createElement("div",{className:c.root},I&&r.a.createElement(B,{avatar:I,callback:D}),o?(null===o||void 0===o?void 0:o._id)===(null===g||void 0===g?void 0:g._id)?r.a.createElement("div",{className:c.avatarContainer},r.a.createElement(m.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},className:c.avatarContainer,badgeContent:r.a.createElement(E.a,{callback:L},r.a.createElement("div",{className:c.badge},r.a.createElement(v.a,null)))},r.a.createElement(O.a,{className:[c.avatar,C&&c.darken].join(" "),user:o}),C>0&&r.a.createElement(d.a,{variant:"static",value:C,className:c.progress}))):r.a.createElement(O.a,{className:c.avatar,user:o}):r.a.createElement(f.a,{animation:"wave",variant:"circle",width:150,height:150,className:c.avatar}),o?r.a.createElement(h.a,{variant:"h5",className:c.name},null===o||void 0===o?void 0:o.username,(null===o||void 0===o?void 0:o.verified)&&r.a.createElement(p.a,{className:c.verified,color:"primary"})):r.a.createElement(f.a,{animation:"wave",variant:"rect",width:100,height:20,className:c.skeleton}),r.a.createElement("div",{className:c.profileMenu},o?r.a.createElement(r.a.Fragment,null,r.a.createElement(w,{text:"Polls",value:t}),r.a.createElement(w,{text:"Since",value:R}),r.a.createElement(w,{text:"Total votes",value:a})):r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{animation:"wave",variant:"rect",width:170,height:20,className:c.skeleton}),r.a.createElement(f.a,{animation:"wave",variant:"rect",width:170,height:20,className:c.skeleton}),r.a.createElement(f.a,{animation:"wave",variant:"rect",width:170,height:20,className:c.skeleton}))))},U=a(330),W=a(69),H=a(314),F=a(65),V=a(59);t.default=function(){var e=Object(i.f)(),t=Object(i.h)().username,a=Object(k.b)().user,c=Object(V.e)(t),l=c.data,s=c.mutate,u=Object(V.d)(t),m=u.data,d=u.mutate,h=u.isValidating;Object(n.useEffect)((function(){t||(a?e.push("/profile/".concat(a.username)):e.push("/login"))}),[t,e,a]);var v=Object(n.useMemo)((function(){return(null===a||void 0===a?void 0:a.username)===t}),[a,t]),p=Object(n.useMemo)((function(){return v?"Create a poll and it will show up here.":"This user has not uploaded anything yet."}),[v]),g=Object(n.useMemo)((function(){return(null===m||void 0===m?void 0:m.reduce((function(e,t){var a=t.contents,n=a.left,r=a.right;return e+n.votes+r.votes}),0))||0}),[m]);return r.a.createElement(o.a,{maxWidth:"sm",disableGutters:!0},r.a.createElement(z,{userInfo:l,setUserInfo:s,savedPolls:(null===m||void 0===m?void 0:m.length)||0,totalVotes:g}),m?m.length?r.a.createElement(U.a,{polls:m,mutate:d}):r.a.createElement(F.a,{message:p}):h&&r.a.createElement(W.a,null),v&&r.a.createElement(H.a,null))}}}]);
//# sourceMappingURL=9.dbbe6101.chunk.js.map