(this.webpackJsonpwhich=this.webpackJsonpwhich||[]).push([[8],{233:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(60),l=a(77),o=Object(i.a)({root:{position:"absolute",width:"100%",height:"100%"},image:{objectFit:"cover",pointerEvents:"none",width:"100%",height:"100%"}});t.a=function(e){var t=e.src,a=e.alt,n=o();return r.a.createElement("picture",{className:n.root},r.a.createElement(l.a,{src:t,alt:a,className:n.image}))}},260:function(e,t,a){"use strict";var n=a(63),r=a(0),i=a.n(r),l=a(10),o=a(185),c=a(186),s=a(397),u=a(60),m=a(290),d=a.n(m),h=Object(u.a)((function(e){var t;return{root:(t={zIndex:1e3,position:"fixed"},Object(n.a)(t,e.breakpoints.down("sm"),{right:e.spacing(2),bottom:e.spacing(8)}),Object(n.a)(t,e.breakpoints.up("md"),{right:e.spacing(5),bottom:e.spacing(5)}),t)}}));t.a=function(e){var t=e.hideOnScroll,a=void 0!==t&&t,n=h(),r=Object(l.f)(),u=Object(o.a)();return i.a.createElement(c.a,{appear:!1,direction:"up",in:!a||!u},i.a.createElement(s.a,{onClick:function(){r.push("/new")},className:n.root,color:"secondary"},i.a.createElement(d.a,null)))}},261:function(e,t,a){"use strict";var n=a(62),r=a.n(n),i=a(71),l=a(12),o=a(0),c=a.n(o),s=a(295),u=a(80),m=a.n(u),d=a(296),h=a(287),v=a(60),g=a(289),p=a(369),f=a(78),b=a(288),E=a.n(b),w=Object(v.a)({root:{position:"absolute",color:"white",top:"86%",fontSize:20,textShadow:"0 0 3px black",display:"flex",alignItems:"center"},left:{left:30},right:{right:30}}),k=function(e){var t=e.value,a=e.which,n=e.like,r=w();return c.a.createElement("div",{className:"".concat(r.root," ").concat(r[a])},n&&c.a.createElement(E.a,null),"".concat(t,"%"))},O=a(75),j=a(233),y=a(27),x=a(32),C={month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"},N=Object(v.a)((function(e){return{media:{display:"flex",height:e.spacing(50)},rateLine:{position:"relative",width:"100%",height:e.spacing(2),backgroundColor:e.palette.primary.light,transitionDuration:"0.5s"},highlight:{backgroundColor:"".concat(e.palette.primary.main," !important")},fillRateLine:{height:e.spacing(2),backgroundColor:e.palette.primary.light,transitionDuration:"0.5s"}}})),S=c.a.memo((function(e){var t,a,n=e.poll,r=e.setPoll,i=N(),l=n.author,o=n.contents,s=o.left,u=o.right,m=n.vote,d=Object(f.b)().enqueueSnackbar,v=Object(x.b)().isAuthenticated,b=new Date(n.createdAt).toLocaleString("default",C),E=function(e){if(v)if(m)d("You have already voted in this poll",{variant:"error"});else{var t={which:e,pollId:n._id},a=Object(h.a)({},n);a.contents[e].votes+=1,a.vote=Object(h.a)({_id:"",authorId:"",createdAt:new Date},t),r(a),Object(y.c)("votes/",t)}else d("Unauthorized users can not vote in polls",{variant:"error"})};s.votes||u.votes?a=100-(t=Math.round(s.votes/(s.votes+u.votes)*100)):(t=0,a=0);var w=s.votes>=u.votes?"left":"right";return c.a.createElement(g.a,{elevation:3},c.a.createElement(O.a,{user:l,info:b}),c.a.createElement("div",{className:i.media},c.a.createElement(p.a,{onDoubleClick:function(){return E("left")},className:i.media},c.a.createElement(j.a,{src:s.url}),c.a.createElement(k,{value:t,which:"left",like:"left"===(null===m||void 0===m?void 0:m.which)})),c.a.createElement(p.a,{onDoubleClick:function(){return E("right")},className:i.media},c.a.createElement(j.a,{src:u.url}),c.a.createElement(k,{value:a,which:"right",like:"right"===(null===m||void 0===m?void 0:m.which)}))),c.a.createElement("div",{className:"".concat(i.rateLine," ").concat("right"===w?i.highlight:"")},c.a.createElement("div",{className:"".concat(i.fillRateLine," ").concat("left"===w?i.highlight:""),style:{width:"".concat(t,"%")}})))})),I=c.a.memo((function(e){var t=e.polls,a=e.mutate,n=e.index,r=e.style,i=e._key,l=t[n],s=Object(o.useCallback)((function(e){var r=Object(d.a)(t);r[n]=e,a([],!1),a(r,!1)}),[a,n,t]);return c.a.createElement("div",{key:"".concat(i,"-").concat(l._id),style:r},c.a.createElement(S,{poll:l,setPoll:s}))}),(function(e,t){return e._key===t._key&&(e.index===t.index&&e.polls===t.polls)}));t.a=function(e){var t=e.polls,a=e.mutate,n=Object(o.useState)(10),u=Object(l.a)(n,2),d=u[0],h=u[1],v=Object(o.useCallback)((function(e){var n=e.index,r=e.style,i=e.key;return c.a.createElement(I,{polls:t,mutate:a,index:n,style:r,key:i,_key:i})}),[t,a]),g=Object(o.useCallback)(Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h((function(e){return e+10}));case 1:case"end":return e.stop()}}),e)}))),[]),p=Object(o.useCallback)((function(e){return e.index<d-1||d===t.length}),[d,t]),f=Object(o.useMemo)((function(){return m.a.min([d,t.length])||t.length}),[d,t.length]);return c.a.createElement(s.d,null,(function(e){var t=e.height,a=e.isScrolling,n=e.registerChild,r=e.onChildScroll,i=e.scrollTop;return c.a.createElement(s.a,{disableHeight:!0},(function(e){var l=e.width;return c.a.createElement("div",{ref:n},c.a.createElement(s.b,{isRowLoaded:p,loadMoreRows:g,rowCount:f,threshold:1},(function(e){var n=e.onRowsRendered,o=e.registerChild;return c.a.createElement(s.c,{autoHeight:!0,height:t,isScrolling:a,onScroll:r,rowCount:f,rowHeight:550,rowRenderer:v,scrollTop:i,width:l,containerStyle:{pointerEvents:"auto"},overscanRowCount:2,onRowsRendered:n,ref:o})})))}))}))}},262:function(e,t,a){"use strict";var n=a(12),r=a(0),i=a.n(r),l=a(394),o=a(240),c=a.n(o),s=a(300),u=a(301),m=a(302),d=a(303),h=a(407),v=a(304),g=function(e){var t=e.setIsOpen,a=e.isOpen,o=e.callback,c=Object(r.useState)(""),g=Object(n.a)(c,2),p=g[0],f=g[1],b=function(){t(!1)};return i.a.createElement("div",null,i.a.createElement(s.a,{open:a,onClose:b},i.a.createElement(u.a,null,"Upload via link"),i.a.createElement(m.a,null,i.a.createElement(d.a,null,"Provide a valid URL to your image:"),i.a.createElement(h.a,{autoFocus:!0,margin:"dense",id:"name",label:"Image URL",type:"text",fullWidth:!0,autoComplete:"off",onChange:function(e){f(e.target.value)}})),i.a.createElement(v.a,null,i.a.createElement(l.a,{onClick:b,color:"primary"},"Cancel"),i.a.createElement(l.a,{onClick:function(){var e=p;if(p.startsWith("https://www.instagram.com/")){var t=p.match("/p/(.*)/"),a=t&&t[1];e="https://www.instagram.com/p/".concat(a,"/media/?size=l")}else if(p.startsWith("https://drive.google.com/")){var n=p.match("/d/(.*)/"),r=n&&n[1];e="https://drive.google.com/uc?export=view&id=".concat(r)}o(e||""),b()},color:"primary",disabled:!p.length},"Submit"))))};t.a=function(e){var t=e.callback,a=e.children,o=Object(r.useState)(!1),s=Object(n.a)(o,2),u=s[0],m=s[1],d=function(){m(!0)},h=i.a.createElement(l.a,{onClick:d,variant:"outlined",color:"primary",startIcon:i.a.createElement(c.a,null)},"Attach a link"),v=a&&i.a.Children.toArray(a)[0];return i.a.createElement(i.a.Fragment,null,i.a.createElement(g,{callback:t,isOpen:u,setIsOpen:m}),i.a.isValidElement(v)?i.a.cloneElement(v,{onClick:d}):h)}},410:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(10),l=a(370),o=a(396),c=a(43),s=a(60),u=a(305),m=a.n(u),d=a(95),h=a.n(d),v=a(395),g=Object(s.a)({root:{position:"relative"},menuButton:{width:200,height:50,textAlign:"center"},menuNumber:{fontWeight:800,color:"black"},menuText:{color:"darkgray"}}),p=function(e){var t=e.text,a=e.value,n=g();return r.a.createElement("div",{className:n.menuButton},r.a.createElement("div",{className:n.menuNumber},a),r.a.createElement("div",{className:n.menuText},t))},f=a(262),b=a(34),E=a(27),w=a(32),k=Object(s.a)((function(e){return{root:{position:"relative",marginBottom:e.spacing(4)},avatar:{width:150,height:150,margin:"0 auto"},name:{margin:e.spacing(1,0),display:"flex",alignItems:"center",justifyContent:"center"},verified:{marginLeft:e.spacing(.5),width:e.spacing(3),height:e.spacing(3)},profileMenu:{display:"flex",width:"100%",height:50,marginTop:e.spacing(6),borderBottom:"1px solid lightgray"},menuButton:{width:200,height:50,textAlign:"center"},badge:{width:e.spacing(5),height:e.spacing(5),borderRadius:"50%",cursor:"pointer",background:"#d3d3d3",display:"flex",alignItems:"center","& svg":{margin:"0 auto"}},avatarContainer:{position:"relative",textAlign:"center"},menuNumber:{fontWeight:800,color:"black"},menuText:{color:"darkgray"},skeleton:{margin:"10px auto",borderRadius:2}}})),O=function(e){var t=e.savedPolls,a=e.totalVotes,n=e.setUserInfo,i=e.userInfo,l=k(),s=Object(w.b)().user,u=new Date((null===i||void 0===i?void 0:i.createdAt)||"").toLocaleDateString();return r.a.createElement("div",{className:l.root},i?(null===i||void 0===i?void 0:i._id)===(null===s||void 0===s?void 0:s._id)?r.a.createElement(f.a,{callback:function(e){var t=null===s||void 0===s?void 0:s._id;Object(E.b)("/users/".concat(t),{avatarUrl:e}).then((function(e){n(e.data)}))}},r.a.createElement("div",{className:l.avatarContainer},r.a.createElement(o.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement("div",{className:l.badge},r.a.createElement(m.a,null))},r.a.createElement(b.a,{className:l.avatar,user:i})))):r.a.createElement(b.a,{className:l.avatar,user:i}):r.a.createElement(v.a,{animation:"wave",variant:"circle",width:150,height:150,className:l.avatar}),i?r.a.createElement(c.a,{variant:"h5",className:l.name},null===i||void 0===i?void 0:i.username,(null===i||void 0===i?void 0:i.verified)&&r.a.createElement(h.a,{className:l.verified,color:"primary"})):r.a.createElement(v.a,{animation:"wave",variant:"rect",width:100,height:20,className:l.skeleton}),r.a.createElement("div",{className:l.profileMenu},i?r.a.createElement(r.a.Fragment,null,r.a.createElement(p,{text:"Polls",value:t}),r.a.createElement(p,{text:"Since",value:u}),r.a.createElement(p,{text:"Total votes",value:a})):r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{animation:"wave",variant:"rect",width:170,height:20,className:l.skeleton}),r.a.createElement(v.a,{animation:"wave",variant:"rect",width:170,height:20,className:l.skeleton}),r.a.createElement(v.a,{animation:"wave",variant:"rect",width:170,height:20,className:l.skeleton}))))},j=a(261),y=a(52),x=a(260),C=a(49),N=a(74);t.default=function(){var e=Object(i.f)(),t=Object(i.g)().username,a=Object(w.b)().user,o=Object(N.d)(t),c=o.data,s=o.mutate,u=Object(N.c)(t),m=u.data,d=u.mutate,h=u.isValidating;Object(n.useEffect)((function(){t||(a?e.push("/profile/".concat(a.username)):e.push("/login"))}),[t,e,a]);var v=Object(n.useMemo)((function(){return(null===a||void 0===a?void 0:a.username)===t}),[a,t]),g=Object(n.useMemo)((function(){return v?"Create a poll and it will show up here.":"This user has not uploaded anything yet."}),[v]),p=Object(n.useMemo)((function(){return(null===m||void 0===m?void 0:m.reduce((function(e,t){var a=t.contents,n=a.left,r=a.right;return e+n.votes+r.votes}),0))||0}),[m]);return r.a.createElement(l.a,{maxWidth:"sm",disableGutters:!0},r.a.createElement(O,{userInfo:c,setUserInfo:s,savedPolls:(null===m||void 0===m?void 0:m.length)||0,totalVotes:p}),m?m.length?r.a.createElement(j.a,{polls:m,mutate:d}):r.a.createElement(C.a,{message:g}):h&&r.a.createElement(y.a,null),v&&r.a.createElement(x.a,null))}}}]);
//# sourceMappingURL=8.46204175.chunk.js.map